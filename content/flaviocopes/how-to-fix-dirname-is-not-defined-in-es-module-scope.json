{
  "title": "How to fix \"__dirname is not defined in ES module scope\"",
  "url": "https://flaviocopes.com/fix-dirname-not-defined-es-module-scope/",
  "date": "Mon, 18 Apr 2022 07:00:00 +0200",
  "content": "        <p>I stumbled on this error while I used <code>__dirname</code> inside a <a href=\"https://flaviocopes.com/es-modules/\">ES module</a>.</p><p>In an ES module, you cannot use <code>__dirname</code>.</p><p>Using <code>__dirname</code> in a Node script you can get the path of the folder <strong>where the current JavaScript file resides</strong>, and many Node.js projects use this.</p><p>But if you use it inside an ES module, you can&rsquo;t use this, as the infamous &ldquo;__dirname is not defined in ES module scope&rdquo; error shows up.</p><p>What can you do in this case?</p><p>I solved this problem by using a solution I found on the Node.js GitHub issues.</p><p>You first need to import the <a href=\"https://flaviocopes.com/node-module-path/\">Node.js <code>path</code> module</a> and the <code>fileURLToPath</code> function from the <code>url</code> module:</p><div class=\"highlight\"><pre tabindex=\"0\" ><code class=\"language-js\" data-lang=\"js\"><span >import</span> <span >path</span> <span >from</span> <span >&#39;path&#39;</span>;<span >import</span> { <span >fileURLToPath</span> } <span >from</span> <span >&#39;url&#39;</span>;</code></pre></div><p>Then you can replicate the functionality of <code>__dirname</code> in this way:</p><div class=\"highlight\"><pre tabindex=\"0\" ><code class=\"language-js\" data-lang=\"js\"><span >const</span> <span >__</span><span >filename</span> <span >=</span> <span >fileURLToPath</span>(<span >import</span>.<span >meta</span>.<span >url</span>);<span >const</span> <span >__</span><span >dirname</span> <span >=</span> <span >path</span>.<span >dirname</span>(<span >__</span><span >filename</span>);</code></pre></div><p>This, incidentally, also replicates <code>__filename</code>, which returns the filename of the code which is executed.</p><p>Now you can use <code>__dirname</code> as usual:</p><div class=\"highlight\"><pre tabindex=\"0\" ><code class=\"language-js\" data-lang=\"js\"><span >console</span>.<span >log</span>(<span >__</span><span >dirname</span>)</code></pre></div>      ",
  "image": "https://flaviocopes.com/fix-dirname-not-defined-es-module-scope/banner.png",
  "description": "Here is how to fix the \"__dirname is not defined in ES module scope\" error",
  "publisher": "Flaviocopes",
  "publisherUrl": "https://flaviocopes.com/"
}